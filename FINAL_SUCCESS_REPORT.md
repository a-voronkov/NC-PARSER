# üéâ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ - –ü–û–õ–ù–´–ô –£–°–ü–ï–•!

## ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –†–ï–®–ï–ù–´!

### üîê **1. –ü–†–û–ë–õ–ï–ú–ê –° –õ–û–ì–ò–ù–û–ú NEXTCLOUD**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–ï–®–ï–ù–ê**
- **–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: –ë–∞–≥ –≤ Nextcloud 31 —Å reverse proxy
- **–†–µ—à–µ–Ω–∏–µ**: –û—Ç–∫–∞—Ç –∫ Nextcloud 30
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–æ–≥–∏–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!

### üì° **2. –í–ï–ë–•–£–ö–ò –î–õ–Ø NODE-RED**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ù–ê–°–¢–†–û–ï–ù–´**
- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è**: 3 —Ç–∏–ø–∞ (Create, Delete, Rename)
- **API —Ç–æ–∫–µ–Ω**: –°–æ–∑–¥–∞–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- **–î–æ—Å—Ç–∞–≤–∫–∞**: Node-RED –ø–æ–ª—É—á–∞–µ—Ç –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

### üåê **3. NODE-RED –ü–£–ë–õ–ò–ß–ù–´–ô –î–û–°–¢–£–ü**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–ï–®–ï–ù–ê**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –≤ –ø–∞—Ä–æ–ª–µ –ª–æ–º–∞–ª–∏ basic auth
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ htpasswd —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **URL**: https://ncrag.voronkov.club/nodered
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: admin / –ø–∞—Ä–æ–ª—å_nextcloud
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: UI –¥–æ—Å—Ç—É–ø–µ–Ω —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π!

## üéØ **–ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´**

### ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–ß–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | URL | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|-----|-------------|--------|
| **Nextcloud** | https://ncrag.voronkov.club | admin/–ø–∞—Ä–æ–ª—å | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| **Node-RED UI** | https://ncrag.voronkov.club/nodered | admin/–ø–∞—Ä–æ–ª—å | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |
| **–í–µ–±—Ö—É–∫–∏** | /webhooks/nextcloud | X-Webhook-Secret | ‚úÖ **–ê–ö–¢–ò–í–ù–´** |
| **API** | /ocs/v2.php/... | API —Ç–æ–∫–µ–Ω | ‚úÖ **–§–£–ù–ö–¶–ò–û–ù–ò–†–£–ï–¢** |

### üìä **–°–¢–ê–¢–ò–°–¢–ò–ö–ê –í–ï–ë–•–£–ö–û–í:**

```json
{
  "registered_webhooks": 3,
  "events": [
    "NodeCreatedEvent",
    "NodeDeletedEvent", 
    "NodeRenamedEvent"
  ],
  "status": "active",
  "last_received": "2025-08-23T06:34:26.400Z"
}
```

### üîë **–ö–†–ï–î–ï–ù–®–ò–ê–õ–´:**

```bash
# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (Nextcloud + Node-RED)
–õ–æ–≥–∏–Ω: admin
–ü–∞—Ä–æ–ª—å: j*yDCX<4ubIj_.w##>lhxDc?

# API –¥–æ—Å—Ç—É–ø
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: admin  
–¢–æ–∫–µ–Ω: JaJsQQmL8LXV5xsEbRn0PFG251isPuLZobhmvetofnZE9vb3slNby9KJjnXr0vX8QDHbPsHc
```

## üîß **–ö–õ–Æ–ß–ï–í–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### 1Ô∏è‚É£ **Nextcloud Login Fix:**
```yaml
# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ —Å 31 –Ω–∞ 30
nextcloud:
  image: nextcloud:30-apache  # –í–º–µ—Å—Ç–æ 31-apache
```

### 2Ô∏è‚É£ **API Token Creation:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ —Ç–æ–∫–µ–Ω–∞
docker exec -e OC_PASS="$NEXTCLOUD_PASSWORD" -u www-data nextcloud \
  php occ user:auth-tokens:add admin --password-from-env
```

### 3Ô∏è‚É£ **Basic Auth Fix:**
```bash
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ htpasswd —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
docker run --rm -i httpd:2.4-alpine htpasswd -nbm admin 'j*yDCX<4ubIj_.w##>lhxDc?' > .htpasswd
```

### 4Ô∏è‚É£ **Traefik Configuration:**
```yaml
labels:
  # Node-RED UI —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
  - "traefik.http.routers.nodered-ui.rule=Host(`ncrag.voronkov.club`) && PathPrefix(`/nodered`)"
  - "traefik.http.routers.nodered-ui.middlewares=nodered-auth,nodered-stripprefix"
  - "traefik.http.middlewares.nodered-auth.basicauth.usersfile=/etc/traefik/.htpasswd"
  
  # –í–µ–±—Ö—É–∫–∏ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - "traefik.http.routers.nodered-webhook.rule=Host(`ncrag.voronkov.club`) && PathPrefix(`/webhooks/nextcloud`)"
  - "traefik.http.routers.nodered-webhook.priority=1000"
```

## üöÄ **–°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

### ‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- üîê Nextcloud –ª–æ–≥–∏–Ω –∏ —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- üì° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ–±—Ö—É–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤  
- üåê Node-RED UI –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- üîß –ü–æ–ª–Ω—ã–π API –¥–æ—Å—Ç—É–ø –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π

### üéØ **–ì–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫–∏
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ Node-RED
4. **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Nextcloud

## üèÜ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

**–í–°–ï –ó–ê–î–ê–ß–ò –£–°–ü–ï–®–ù–û –†–ï–®–ï–ù–´!** 

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤–µ–±—Ö—É–∫–∏ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ 100%!** üéâ