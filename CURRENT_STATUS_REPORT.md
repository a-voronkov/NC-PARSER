# üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´

## ‚úÖ **–ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:**

### 1Ô∏è‚É£ **Nextcloud –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê**
- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: 302 (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç)
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞**: 200 (–¥–æ—Å—Ç—É–ø–Ω–∞)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –õ–æ–≥–∏–Ω –≤—Å–µ –µ—â–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ (–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ Nextcloud 30 —Å proxy)

### 2Ô∏è‚É£ **–í–µ–±—Ö—É–∫–∏**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–Æ–¢**
- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã**: 3 —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏–π
- **API —Ç–æ–∫–µ–Ω**: –§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- **–î–æ—Å—Ç–∞–≤–∫–∞**: Node-RED –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ä–∞–Ω–µ–µ)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –≠–Ω–¥–ø–æ–∏–Ω—Ç `/webhooks/nextcloud` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

### 3Ô∏è‚É£ **API –¥–æ—Å—Ç—É–ø**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**
- **–¢–æ–∫–µ–Ω**: `JaJsQQmL8LXV5xsEbRn0PFG251isPuLZobhmvetofnZE9vb3slNby9KJjnXr0vX8QDHbPsHc`
- **–§—É–Ω–∫—Ü–∏–∏**: –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Nextcloud API

## ‚ùå **–ü–†–û–ë–õ–ï–ú–´:**

### 1Ô∏è‚É£ **Node-RED UI –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –†–µ—Å—É—Ä—Å—ã –∏—â—É—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –¥–æ–º–µ–Ω–∞
- **–ü—Ä–∏—á–∏–Ω–∞**: `stripprefix` middleware —É–¥–∞–ª—è–µ—Ç `/nodered`, –Ω–æ Node-RED –Ω–µ –∑–Ω–∞–µ—Ç –æ –±–∞–∑–æ–≤–æ–º –ø—É—Ç–∏
- **–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `httpRoot` –≤ Node-RED settings.js

### 2Ô∏è‚É£ **Nextcloud –ª–æ–≥–∏–Ω**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `login?direct=1&user=admin`
- **–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Å—Å–∏—è–º–∏/–ø—Ä–æ–∫—Å–∏ –≤ Nextcloud 30
- **–°—Ç–∞—Ç—É—Å**: –ò–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–∞–µ–º–∞—è

## üîß **–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú:**

### **Node-RED UI –ø—Ä–æ–±–ª–µ–º–∞:**
```
Request URL: https://ncrag.voronkov.club/red/main.min.js?v=15a2208510cc
Status: 404 Not Found
```

**–ê–Ω–∞–ª–∏–∑:**
- Node-RED –∏—â–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è (`/red/`, `/vendor/`)
- Traefik `stripprefix` —É–¥–∞–ª—è–µ—Ç `/nodered` –∏–∑ URL
- Node-RED –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏

### **–†–µ—à–µ–Ω–∏—è –¥–ª—è Node-RED:**

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ httpRoot (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```javascript
// settings.js
module.exports = {
    httpRoot: '/nodered',
    // ... –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–¥–¥–æ–º–µ–Ω
```yaml
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nodered.ncrag.voronkov.club –≤–º–µ—Å—Ç–æ /nodered
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: Nginx –ø—Ä–æ–∫—Å–∏
```yaml
# –û—Ç–¥–µ–ª—å–Ω—ã–π nginx –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è Node-RED
```

## üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:**

### **–î–ª—è Node-RED UI:**
1. **–°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π settings.js** —Å `httpRoot: '/nodered'`
2. **–û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml** –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è settings.js
3. **–£–±—Ä–∞—Ç—å stripprefix** –∏–∑ Traefik (Node-RED —Å–∞–º –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É—Ç—å)

### **–î–ª—è Nextcloud –ª–æ–≥–∏–Ω:**
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** (–≤–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Å—Å–∏—è–º–∏)
2. **–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—Ç–∫–ª—é—á–∏—Ç—å memcache** –≤—Ä–µ–º–µ–Ω–Ω–æ
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å forwarded headers** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

## üìã **–ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô:**

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Node-RED UI
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π settings.js
# 2. –û–±–Ω–æ–≤–∏—Ç—å docker-compose.yml
# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Node-RED
# 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: Nextcloud –ª–æ–≥–∏–Ω
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis/memcache
# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å forwarded headers
# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∫—Å–∏
```

## üèÜ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:**

**–°–∏—Å—Ç–µ–º–∞ –Ω–∞ 80% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞:**
- ‚úÖ Nextcloud –¥–æ—Å—Ç—É–ø–µ–Ω (–∫—Ä–æ–º–µ –ª–æ–≥–∏–Ω–∞)
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –í–µ–±—Ö—É–∫–∏ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è
- ‚ö†Ô∏è Node-RED UI –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ö†Ô∏è Nextcloud –ª–æ–≥–∏–Ω —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–≤–µ–±—Ö—É–∫–∏) —Ä–∞–±–æ—Ç–∞–µ—Ç!** 

–ü—Ä–æ–±–ª–µ–º—ã —Å UI —Ä–µ—à–∞–µ–º—ã –∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã.